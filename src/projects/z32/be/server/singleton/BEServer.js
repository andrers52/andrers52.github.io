"use strict";import Assert from"../../libs/arslib/util/assert.js";import BECommonDefinitions from"../../common/BECommonDefinitions.js";import connector from"./Connector.js";import environment from"../agent/singleton/Environment.js";import AgentDefinitions from"../agent/AgentDefinitions.js";import Util from"../../libs/arslib/util/util.js";if(Util.isNode())var fs=require("fs");function BEServerConstructor(){function t(){connector.setVisibleAgents(),setTimeout(t,AgentDefinitions.AGENTS_CLIENT_REFRESH_INTERVAL)}this.start=function(t){let n;environment.start(BECommonDefinitions.WORLD_WIDTH,BECommonDefinitions.WORLD_HEIGHT),this.config=t||function(){if(!Util.isNode())return{};var t=fs.readFileSync(BECommonDefinitions.CONFIG_JSON);return JSON.parse(t)}(),BECommonDefinitions.start(this.config),"deploy"===BECommonDefinitions.config.buildType&&(Assert.disableAllVerifications=!0),connector.start(!!this.config.localApp),this.currentApp=null,this.currentAppName="",this.setBackgroundImageName=function(t){n=t},this.getBackgroundImageName=function(){return n}},this.startApp=function(n,i,e){this.start(e),BEServer.currentApp=i,BEServer.currentAppName=n,BEServer.currentApp.start(),t()},this.propagateUserEvent=function(t,n,i){environment.propagateUserEvent(t,n,i)}}var BEServer=new BEServerConstructor;export{BEServer as default};