"use strict";import Assert from"../../../../libs/arslib/util/assert.js";import Rectangle from"../../../../libs/arslib/geometry/Rectangle.js";import Vector from"../../../../libs/arslib/geometry/Vector.js";import connector from"../../singleton/Connector.js";export default function ChangesImageWithState(t){let e=this,a=[],r="notInitialized",n={},i={},s={};function o(t){e.imageName=n[t],0===e.getSize().x&&0===e.getSize().x&&(e.rectangle=new Rectangle(e.rectangle.getPosition()||null,new Vector(10,10))),e.audioName=i[t],connector.playSoundInClient(e.audioName)}function c(t){return a.includes(t)}this.currentState="notInitialized",this.changeState=function(t){return Assert.assert(c(t)),s[e.currentState]&&s[e.currentState].call(e),this.currentState=t,o(t),this},this.addActionToExecuteAtStateChange=function(t,e){return Assert.assert(c(t),"ChangesImageWithState#addActionToExecuteAtStateChange error -> invalid state"),Assert.assertIsFunction(e,"ChangesImageWithState#addActionToExecuteAtStateChange error -> action expected to be a function"),s[t]=e,this},function(t){try{r=e.currentState=t.defaultState,t.states.forEach(function(t){a.push(t.stateName),n[t.stateName]=t.image,i[t.stateName]=t.audioName}),o(r)}catch(t){throw"ChangesImageWithState initialization error: resources descriptor reading: "+t}Assert.assert(a.includes(r),"ChangesImageWithState error: resources integrity check failed"),e.currentState=r}(t)};